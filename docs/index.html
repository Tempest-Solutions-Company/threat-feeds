<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Threat Intelligence - Global Security Monitoring | Tempest Solutions Network</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-brand">
                <i class="fas fa-network-wired"></i>
                <span>Tempest Solutions Network</span>
            </div>
            <div class="nav-menu" id="nav-menu">
                <a href="index.html" class="nav-link">Home</a>
                <a href="https://tempest-solutions-company.github.io/pihole_blocklists/" class="nav-link">Threat Analytics</a>
                <a href="https://tempest-solutions.network/" class="nav-link">Our Website</a>
            </div>
            <div class="nav-toggle" id="nav-toggle">
                <span></span>
                <span></span>
                <span></span>
            </div>
        </div>
    </nav>

    <main class="threats-page">
        <div class="container">
            <div class="threats-header">
                <h1><i class="fas fa-globe-americas"></i> Global Threat Intelligence</h1>
                <p class="subtitle">Real-time security threat monitoring from our IDS/IPS and firewall systems</p>
                <div class="data-freshness">
                    <i class="fas fa-clock"></i>
                    <span>Last Updated: <span id="last-update-time">Loading...</span></span>
                    <span class="update-frequency">â€¢ Updates every 30 minutes</span>
                </div>
            </div>

            <div class="threat-controls">
                <div class="control-group">
                    <label for="threat-filter">Filter by Threat Type:</label>
                    <select id="threat-filter" class="threat-select">
                        <option value="all">All Threats</option>
                        <option value="compromised_host">Compromised Host</option>
                        <option value="dns_attack">DNS Attacks</option>
                        <option value="port_scanning">Port Scanning</option>
                        <option value="sql_injection">SQL Injection</option>
                        <option value="ssh_scanning">SSH Scanning</option>
                        <option value="terminal_server_attack">Terminal Server Attacks</option>
                        <option value="tor_traffic">Tor Traffic</option>
                        <option value="unknown">Unknown Threats</option>
                    </select>
                </div>
                <div class="control-group">
                    <a href="https://github.com/Tempest-Solutions-Company/threat-feeds" target="_blank" class="github-button">
                        <i class="fab fa-github"></i>
                        View Raw Data on GitHub
                    </a>
                </div>
            </div>

            <div class="threat-map-container">
                <div id="threat-map" role="img" aria-label="Interactive world map showing threat distribution by country" tabindex="0"></div>
                <div class="map-legend">
                    <h4>Threat Intensity</h4>
                    <div class="legend-scale">
                        <div class="legend-item">
                            <div class="legend-color low"></div>
                            <span>Low (1-19)</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color medium"></div>
                            <span>Medium (20-99)</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color high"></div>
                            <span>High (100-499)</span>
                        </div>
                        <div class="legend-item">
                            <div class="legend-color critical"></div>
                            <span>Critical (500+)</span>
                        </div>
                    </div>
                </div>
                <div id="country-tooltip" class="country-tooltip" style="display: none;"></div>
            </div>

            <div class="threat-stats">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-shield-alt"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="total-threats">0</h3>
                            <p>Total Threats (30 days)</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-globe"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="countries-count">0</h3>
                            <p>Countries Detected</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-bug"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="top-threat-type">Loading...</h3>
                            <p>Most Common Threat</p>
                        </div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-icon">
                            <i class="fas fa-map-marker-alt"></i>
                        </div>
                        <div class="stat-content">
                            <h3 id="top-country">Loading...</h3>
                            <p>Top Source Country</p>
                        </div>
                    </div>
                </div>
            </div>

            <div class="data-sources-section">
                <h2>Data Sources & Interpretation</h2>
                <div class="info-grid">
                    <div class="info-card">
                        <h3><i class="fas fa-database"></i> Threat Types</h3>
                        <ul>
                            <li><strong>Compromised Host:</strong> Detected botnet or compromised system traffic</li>
                            <li><strong>DNS Attacks:</strong> Malicious DNS queries and DNS-based attacks</li>
                            <li><strong>Port Scanning:</strong> Automated port scanning and reconnaissance</li>
                            <li><strong>SQL Injection:</strong> Database attack attempts and SQL injection probes</li>
                            <li><strong>SSH Scanning:</strong> Brute force SSH login attempts</li>
                            <li><strong>Terminal Server:</strong> RDP and terminal service attacks</li>
                            <li><strong>Tor Traffic:</strong> Anonymous network traffic detection</li>
                            <li><strong>Unknown:</strong> Unclassified security events</li>
                        </ul>
                    </div>
                    <div class="info-card">
                        <h3><i class="fas fa-cogs"></i> Data Collection</h3>
                        <p>Our threat intelligence is collected from:</p>
                        <ul>
                            <li>IDS/IPS systems monitoring network traffic</li>
                            <li>Firewall logs with CEF message format</li>
                            <li>Real-time analysis of security events</li>
                            <li>30-day rolling window for data freshness</li>
                        </ul>
                        <p><strong>Update Policy:</strong> IP addresses are tracked for 30 days. If no activity is detected within this period, they are automatically removed from our feeds.</p>
                    </div>
                    <div class="info-card">
                        <h3><i class="fas fa-mouse-pointer"></i> Using the Heat Map</h3>
                        <ul>
                            <li><strong>Hover:</strong> Mouse over countries to see threat details</li>
                            <li><strong>Filter:</strong> Use the dropdown to view specific threat types</li>
                            <li><strong>Colors:</strong> Intensity indicates threat frequency from that country</li>
                            <li><strong>Keyboard:</strong> Use Tab to navigate, Enter to select</li>
                        </ul>
                    </div>
                </div>
            </div>

            <div class="threat-analysis-section">
                <h2>Current Threat Landscape Analysis</h2>
                <div class="analysis-content">
                    <div class="analysis-card">
                        <h3><i class="fas fa-chart-bar"></i> 30-Day Summary</h3>
                        <div id="threat-summary">
                            <div class="loading-indicator">
                                <i class="fas fa-spinner fa-spin"></i>
                                <span>Analyzing threat data...</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="analysis-card">
                        <h3><i class="fas fa-globe-europe"></i> Geographical Trends</h3>
                        <div id="geo-trends">
                            <div class="loading-indicator">
                                <i class="fas fa-spinner fa-spin"></i>
                                <span>Processing geographical data...</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="analysis-card recommendations">
                        <h3><i class="fas fa-shield-alt"></i> Protection Recommendations</h3>
                        <div class="recommendations-content">
                            <div class="recommendation-item">
                                <i class="fas fa-lock"></i>
                                <div>
                                    <h4>Strong Authentication</h4>
                                    <p>Implement multi-factor authentication for all SSH and RDP services to prevent brute force attacks.</p>
                                </div>
                            </div>
                            <div class="recommendation-item">
                                <i class="fas fa-fire"></i>
                                <div>
                                    <h4>Firewall Configuration</h4>
                                    <p>Configure firewalls to block unnecessary ports and implement geo-blocking for high-risk countries.</p>
                                </div>
                            </div>
                            <div class="recommendation-item">
                                <i class="fas fa-update"></i>
                                <div>
                                    <h4>Regular Updates</h4>
                                    <p>Keep all systems updated with the latest security patches to prevent exploitation of known vulnerabilities.</p>
                                </div>
                            </div>
                            <div class="recommendation-item">
                                <i class="fas fa-eye"></i>
                                <div>
                                    <h4>Monitoring</h4>
                                    <p>Implement continuous monitoring and logging to detect and respond to threats quickly.</p>
                                </div>
                            </div>
                            <div class="recommendation-item">
                                <i class="fas fa-database"></i>
                                <div>
                                    <h4>Database Security</h4>
                                    <p>Use parameterized queries and input validation to prevent SQL injection attacks.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h4>Tempest Solutions Network</h4>
                    <p>Empowering local business through technology</p>
                </div>
                <div class="footer-section">
                    <h4>Threat Intelligence</h4>
                    <ul>
                        <li><a href="threats.html">Global Heat Map</a></li>
                        <li><a href="https://github.com/Tempest-Solutions-Company/threat-feeds" target="_blank">Raw Data Feeds</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Legal</h4>
                    <ul>
                        <li><a href="terms.html">Terms of Service</a></li>
                        <li><a href="privacy.html">Privacy Policy</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Connect</h4>
                    <ul>
                        <li><a href="https://tempest-solutions.org.uk" target="_blank">Main Website</a></li>
                        <li><a href="https://server-companion.com" target="_blank">Server Companion</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; <span id="current-year">1997</span>-<span id="end-year"></span> Tempest Solutions Network. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="script.js"></script>
    <script src="threats.js"></script>
</body>
</html>
